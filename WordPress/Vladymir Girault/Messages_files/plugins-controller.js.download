define(["lodash"],function(e){"use strict";return["$http","$scope","$window","eoAuth","eoPlugins","$state","$modal","eoGoogleAnalytics","eventLog","eoPluginsDetailService","eoIntegrationPermission",function(t,i,n,o,s,r,a,l,u,g,c){l.ga("Integrations","available integrations viewed"),i.selected=r.current.name,r.params.self&&"true"===r.params.self&&(i.selected="plugins.myexistingintegrations"),o.organization&&o.organization.enablePlugins&&s.getApplicationList().then(function(e){i.appList=e,g.getTokenOrAuthorizationUrl(o.user.userId,o.user.orgId).then(function(e){if(!e.exist&&e.redirectUrl){i.googleRedirectUrl=e.redirectUrl;var t=s.getGoogleDriveAppObject();i.appList.push(t),i.appList.sort(function(e,t){var i=e.appName,n=t.appName;return i<n?-1:i>n?1:0})}})}),i.addIntegration=function(e,t){if("webhooks"===t)r.go("webhooksroomselect",{id:e,newflag:!0});else if("googlecalendar"===t)r.go("googlecalendarselect",{id:e});else if("googledrive"===t){var n={redirectUrl:i.googleRedirectUrl,provider:"Google Drive"};c.confirm(n)}else r.go("webhooksroomselect",{id:e,newflag:!0})},i.$on("$stateChangeStart",function(e,t,n){i.selected=t.name,n.self&&"true"===n.self&&(i.selected="plugins.myexistingintegrations")}),i.addBuildVersion=function(e){return e?e+"?"+n.dashVersion:void 0};var d=["Google Calendar","Trello","Zapier","Hootsuite","Asana","Zendesk","Freshdesk","Desk.com","Mailchimp","Google Analytics","Dropbox","Google Drive","Salesforce","Basecamp","Youcanbookme","Cloud9","Heroku","Invision App","Wipster","IFTT","Koding","Amazon Workspaces","Citrix XenDesktop","FramerJS"];i.requestIntegration=function(){var t=i.$new(),n=a.open({templateUrl:"@templates/plugins/request-dialog.html",scope:e.extend(t,{items:d.sort().map(function(e){return{name:e}}),other:"",process:function(){return{items:e.filter(this.items,"checked").map(function(e){return e.name}),other:e.filter(this.other.split(",").map(function(e){return e.trim()}))}}})});n.result.then(function(e){e.event_label="user_submits_plugin_request";var t={event:"click",location:"dash",sublocation:"plugins",timestamp:new Date,userId:o.user.userId,data:[e]};u.log(t),a.confirmBox("Thank you! Your request has been submitted.")}),n.result.finally(function(){t.$destroy(),n=null})},i.tabs=[{name:"Add a Service",active:"plugins"===i.selected||"plugins.detail"===i.selected||"plugins.integration"===i.selected,state:"plugins"},{name:"Configured Services",active:"plugins.existingintegrations"===i.selected||"plugins.googledriveresponse"===i.selected,state:"plugins.existingintegrations({self: false})"},{name:"Configured By You",active:"plugins.myexistingintegrations"===i.selected,state:"plugins.existingintegrations({self: true})"}]}]});