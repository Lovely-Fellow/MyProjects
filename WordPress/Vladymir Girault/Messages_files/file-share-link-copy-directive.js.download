define(["./common","angular"],function(e,i){"use strict";e.directive("eoFileShareLinkCopy",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{file:"="},templateUrl:function(){return e.templatePath+"file-share-link-copy-directive.html"},controller:["$scope","eoFiles","eoAlert","clipboard","$timeout","eoFileShareDialog",function(e,n,t,c,o,l){var r=e,a=r.file;r.generateLink=function(){r.fileLink||(a.fileId?(r.creatingLink=!0,n.createSharedFileLink(a).then(function(e){r.fileLink=e},function(){t.inline({type:"danger",template:"Could not create file link."})}).finally(function(){r.creatingLink=!1})):r.fileLink=a.objectUrl)},r.copyShareLink=function(e){try{if(r.creatingLink)return void o(function(){i.element(e.currentTarget).click()},500);c.copyText(r.fileLink),r.copySuccess()}catch(e){r.copyFail()}},r.copySuccess=function(){t.inline({type:"success",template:"Link copied to clipboard."})},r.copyFail=function(){l.show(a)}}]}})});