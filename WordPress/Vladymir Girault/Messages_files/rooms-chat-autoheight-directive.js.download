define(["angular","lodash"],function(e,i){"use strict";return["$window",function(t){return{restrict:"A",priority:1e4,link:function(n,r){var h,o=e.element(t),s=i.debounce(function(){var e=r.find(".composer-panel");if(!h&&(h=r.find(".story-panel"),!h.length))return void(h=null);var i=r.height()-e.height();if(e.height()<=0){if(!this.prevHeight)return;i=this.prevHeight}else this.prevHeight=i;var t=e.find(".story-attachments-both");if(t.height()>1e6)return t.css("height","0px"),void s();t.css("height",""),h.css({height:i,top:0}),n.$emit("room:resizeChat")},10);o.bind("resize",s),n.$on("$destroy",function(){o.unbind("resize",s)}),n.$on("room.uiResize",function(e,t){s(),t&&i.delay(t,10)}),i.delay(s,10)}}}]});