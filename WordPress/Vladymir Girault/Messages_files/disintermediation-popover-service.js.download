define(["./common","lodash"],function(t,e){"use strict";var n=t.templatePath+"disintermediation-popover.html";t.factory("eoDisintermediationPopover",["$rootScope","eoDashPopover","eoAuth","eoDisintermediation","eoDashContext",function(t,o,i,r,s){function u(){f&&a&&f.offset(a)}var a,l,c=0,f=null,d={};return t.$on("room:resizeChat",u),{isCategoryHidden:function(t,n){return-1!==e.indexOf(d[n],t)},hideCategory:function(t,e){d[e]||(d[e]=[]),d[e].push(t)},isShowing:function(){return null!==f},show:function(e,u,d){d=d||e.attr("eo-disintermediation-category");var p=i.isClient();if(f&&u<c)return null;if(a=e,f&&d===l&&u===c)return f.offset(e),f;l=d,c=u,f&&(f.dismiss("replace"),f=null);var m=["$scope",function(e){e.paymentProtectionUrl="https://www.upwork.com/hiring/for-clients/payments-and-productivity-on-upwork/#protection",e.category=d,e.isClient=p,e.startVideoCall=function(){s.isReadOnlyMode()||(e.dismiss("hide"),t.$emit("video:start",!0))}}];return f=o.open({templateUrl:n,element:e,controller:m}),f.result.then(function(t){return"turnOff"===t&&r.turnOff(l),"replace"!==t&&(f=null),t}),f}}}])});