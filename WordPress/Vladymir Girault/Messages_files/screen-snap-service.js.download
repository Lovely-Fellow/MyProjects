define(["./common","lodash","./context-service","./analytics-service"],function(e,t){"use strict";e.run(["eoDashContext",function(e){e.isTeamApp()&&require(["annotation"])}]),e.factory("eoScreenSnap",["$injector","$q","eoDashContext","eoGoogleAnalytics",function(e,n,o,r){return{shortcuts:{activeScreen:null,customArea:null},snapCustomArea:function(t,n){this.roomId=t,this.roomName=n,e.get("eoTeamApp").snapCustomArea()},snapActiveScreen:function(t,n){this.roomId=t,this.roomName=n,e.get("eoTeamApp").snapActiveScreen()},show:function(t){r.ga("ScreenSnap","screensnap button clicked",t.roomId?"from Dash":"from UTA"),require(["annotation"],function(){e.get("eoImageAnnotationDialog").show(t)})},updateShortcuts:function(e){var n=t.find(e,{type:"active_screen"}),o=t.find(e,{type:"custom_area"});this.shortcuts.activeScreen=n&&!n.disabled?n.shortcut:null,this.shortcuts.customArea=o&&!o.disabled?o.shortcut:null},fetchScreenSnapConfig:function(){if(this.screenSnapConfigPromise)return this.screenSnapConfigPromise;var t=this,n=e.get("eoTeamApp");return this.screenSnapConfigPromise=n.getScreenSnapConfig(),this.screenSnapConfigPromise.then(function(e){t.supported=e.supported,t.updateShortcuts(e.shortcuts)}),this.screenSnapConfigPromise},getShortcuts:function(){var e=this;return this.fetchScreenSnapConfig().then(function(){return e.shortcuts})},isSupported:function(){var e=this;return o.isTeamApp()?this.fetchScreenSnapConfig().then(function(){return e.supported}):n.when(!1)},saveSnap:function(e){e.roomName=this.roomName,e.roomId=this.roomId,this.show(e),this.roomName=null,this.roomId=null}}}])});