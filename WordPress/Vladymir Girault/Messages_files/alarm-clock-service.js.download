define(["./common","angular","rxjs"],function(n,t,e){"use strict";n.factory("eoAlarmClock",["$interval",function(n){function r(){var n,t;return n=new Date,n.setHours(0,0,0,0),n=n.getTime(),t=new Date(n),t.setHours(24),t=t.getTime(),{today:n,tomorrow:t}}function o(r){return e.Observable.create(function(e){var o=r-Date.now();if(isNaN(o))return e.error("Invalid Timestamp"),void e.complete();o<0?o=0:o>2147483647&&(console.warn("Max tick duration is limited to a 32 bit integer value. Interval duration capped at 2147483647ms"),o=2147483647);var i=n(function(){return r},o,1);i.then(t.noop,function(n){e.error(n)},function(){e.next(r)}),i.finally(function(){n.cancel(i),e.complete()})}).multicast(new e.Subject).refCount()}function i(n){delete c[n]}function u(n){if(!c[n]){var t=o(n);t.subscribe({error:function(){i(n)},complete:function(){i(n)}}),c[n]=t}return c[n]}function a(n){return u(r().tomorrow).subscribe(n)}var c={};return{midnight:function(){return e.Observable.create(function(n){function t(t){n.next(t)}function e(){o.unsubscribe(),o=a(i)}function r(){o.unsubscribe()}var o,i;return i={next:t,complete:e},o=a(i),r})},alarm:function(n){return u(n)},isToday:function(n){var t=r();return this.dayOf(n)===t.today},dayOf:function(n){var t=new Date(n);return t.setHours(0,0,0,0),t.getTime()}}}])});