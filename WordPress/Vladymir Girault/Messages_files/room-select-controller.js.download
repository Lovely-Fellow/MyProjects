define(["./integration-detail","angular"],function(){"use strict";return["$scope","$state","$q","$window","applicationId","eoRooms","eoRoomDialog","eoAuth","eoPluginsDetailService","newIntegrationFlag","eoGoogleAnalytics",function(e,o,t,n,r,i,a,s,u,l,m){e.isClient=s.isClient(),e.isClient=!0,e.application="",e.setupTemplate="",e.roomSelection=[],e.showErrorMessage=!1,e.errorMessageFromBE="",u.getApplicationById(r).then(function(o){m.ga("Integrations","select room screen viewed",o.appName),e.application=o,e.googleOauthUrl="",e.isAuthorized=!1,"oauth2"===o.metadata.integration_type&&(u.getGoogleOauthUrl().then(function(o){e.googleOauthUrl=o}),u.isAuthorized(s.user.userId,s.user.orgId).then(function(o){e.isAuthorized=o})),e.setupTemplate=u.getSetupTemplate(o.metadata.setupTemplate)}),e.googleDriveLogout=function(){u.googleDriveLogout(s.user.userId,s.user.orgId).then(function(){o.go("plugins")},function(e){n.alert(e[0].message)})},e.submitNewIntegration=function(t){if(-1===t){if(!e.roomSelection.roomNameInput)return void(e.noRoomSelected=!0);if(e.multipleRoomSelected=!1,e.noRoomSelected=!1,!e.roomSelection.roomNameInput.room)return t=void 0,void(e.noRoomSelected=!0);t=e.roomSelection.roomNameInput.room.roomId}var n=e.application.appId,r=s.user.userId,i=s.user.orgId;u.createNewIntegration(n,i,t,r).then(function(t){t.code?(e.errorMessageFromBE=t.message,e.showErrorMessage=!0):(e.showErrorMessage=!1,o.go("integrateddetails",{id:t.integrationId,newflag:l}))})},e.createRoomModal=function(){a.create().result.then(function(o){e.submitNewIntegration(o.roomId)})},e.onRoomSelect=function(o){e.roomSelection.selectedRooms.push(o),e.roomSelection.roomNameInput=""},e.addBuildVersion=function(e){return e?e+"?"+n.dashVersion:void 0},e.getRoomSearch=function(e){return u.searchForRooms(e)},e.roomSelection.selectedRooms=[],e.roomSelection.roomNameInput=""}]});