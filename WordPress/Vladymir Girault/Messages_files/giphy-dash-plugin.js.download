define(["./common"],function(e){"use strict";e.factory("upGiphyDashPlugin",["$q","upGiphyModal","eoAuth","eoUrlAttachment","htmlToTextFilter",function(e,t,i,a,n){return{parse:function(r){if(!i.organization.enableGiphy||!r.message||!r.message.match(/^\/giphy *\S/))return e.when(r);var m=n(r.message.slice(7).trim());return t.open(m).then(function(t){return t&&t.url&&t.image?(r.attachments||(r.attachments=[]),r.attachments.push(a.create(t.url,{preview:JSON.stringify({type:"article",url:t.url,image:t.image.url,"image:width":t.image.width,"image:height":t.image.height,"image:type":"image/gif",title:m,site_name:"GIPHY"})},"giphy:image")),r.message="`/giphy` "+m,r):e.reject()})}}}])});