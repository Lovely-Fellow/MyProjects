define(["angular","./common"],function(r,e){"use strict";var n=1e3;e.factory("eoErrorHandler",["$window","$injector","tlLog",function(e,s,t){function o(){return a}function i(o){var i=s.get("deviceDetector");if(a.length<g){o instanceof Error&&(o=o.stack?{message:r.isString(o.message)?o.message.substring(0,n):o.message,trace:r.isString(o.stack)?o.stack.substring(0,n):o.stack,name:o.name}:{line:o.line,message:r.isString(o.message)?o.message.substring(0,n):o.message});var c={timestamp:Date.now(),url:e.location.href,browser:i.browser,error:o};a.push(c),t.error(c)}}var a=[],g=10;return{log:i,all:o}}]),e.run(["$window","eoErrorHandler",function(e,s){e.onerror&&e.onerror.constructor===Function&&"undefined"==typeof jasmine&&(e.onerror=function(e,t,o,i,a){s.log({message:r.isString(e)?e.substring(0,n):e,file:t,line:o,col:i,trace:r.isString(a)?a.substring(0,n):a})})}])});