define(["./room","angular"],function(e){"use strict";e.controller("eoRoomStoryReport",["$scope",function(e){this.story=e.story,this.submit=function(){e.abuseForm.$valid&&this.complete()},this.complete=function(){var o=this;delete this.error,this.story.setAbuseType(this.reason,this.details).then(function(){e.$close(!0)},function(e){o.error="Sorry we're having trouble communicating with the server.",console.error("Failed to report abusive story. Server side failure details: ",e)})}}]),e.factory("eoRoomStoryReportDialog",["$modal","$rootScope","eoRoomStory",function(o,t,r){return{openReport:function(s){var i=t.$new(!0,t);i.story=s;var n=[r.getAbuseTypes().THIRDPARTY,r.getAbuseTypes().NONE];i.abuseTypes=r.getLabeledAbuseTypes(n);var a=o.open({templateUrl:e.templatePath+"room-story-report-dialog.html",controller:"eoRoomStoryReport as report",windowClass:"notifications",scope:i});return a.result.finally(function(){i.$destroy()}),a}}}])});