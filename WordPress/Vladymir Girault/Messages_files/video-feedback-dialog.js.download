define(["./common","./analytics-service","./event-log-service","config-service","./context-service","angular"],function(e){"use strict";e.controller("videoFeedbackDialogCtrl",["eoAuth","tlSettings","$scope","$modalInstance","eoAlert","eoDashConfig","eoGoogleAnalytics","eventLog","room","eoDashContext",function(e,o,t,a,n,c,r,i,s,d){r.ga("Video","feedback modal opened");var l=this;l.rating=0,l.comments="",l.record=function(){var o={event:"mos_rating",location:"dash",sublocation:"mos_exit_survey",timestamp:new Date,userId:e.user.userId,data:[{type:"dash_call",env:d.getName(),rating:l.rating,comments:l.comments,roomType:s.roomType}]};i.log(o),r.ga("Video","feedback recorded"),o={event:"call_ended",location:"dash",sublocation:"videopage",timestamp:new Date,userId:e.user.userId,data:[{type:"feedback",message:l.comments,env:d.getName(),roomType:s.roomType,opening_uid:s.context&&s.context.jobUid,contract_id:s.contractId,contractor_uid:s.context&&s.context.freelancerId,event_label:"feedback_submitted"}]},i.log(o),a.close(),n.inline({type:"success",template:"Thanks for your feedback!"})}}]).factory("eoVideoFeedbackDialog",["$modal",function(o){return{showDialog:function(t){return o.open({templateUrl:e.templatePath+"video-feedback-dialog.html",controller:"videoFeedbackDialogCtrl as ctrl",resolve:{room:function(){return t}}})}}}])});